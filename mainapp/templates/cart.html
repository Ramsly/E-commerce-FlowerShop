{% extends 'base.html' %} {% load static %} {% block title %}Корзина{% endblock title %} {% block content %} {{cart_session}} {% if cart_session != None %}
<h3 class="main__title">Ваша корзина</h3>
<div class="cart-wishlist__container">
	{% for i in cart_session %} {% for product in products %} {% if i.id == product.id|stringformat:"i" %}
	<article class="cart-wishlist__product">
		<div class="main__image">
			<a href="{{product.get_absolute_url}}">
				<img src="{{product.image.url}}" alt="" />
			</a>
			{% if product.shipping_price == 0 %}
			<span class="signature ship">Бесплатная доставка</span>
			{% else %}
			<span class="signature ship"
				>Доставка <span>{{product.shipping_price}} ₽</span></span
			>
			{% endif %} {% if product.sale_value > 0 %}
			<span class="signature sale"
				>Скидка <span>{{product.sale_value|floatformat}} %</span></span
			>
			{% endif %}
		</div>
		<div class="cart-wishlist__content">
			<div class="cart-wishlist__product-first">
				<form
					action="{% url 'cart:cart-remove' id=product.id %}"
					method="POST"
				>
					{% csrf_token %}

					<input type="hidden" name="url_from" value="{{request.path}}" />
					<input
						type="hidden"
						id="id"
						name="id"
						value="{{ product.id }}"
					/>
					<input
						type="hidden"
						id="price"
						name="price"
						value="{{product.price}}"
					/>
					<input
						type="hidden"
						id="title"
						name="title"
						value="{{ product.title }}"
					/>
					<button class="cart-wishlist__product-delete">
						<span>&times;</span>
					</button>
				</form>
				<div class="main__product_title margin">
					<a
						href="{{ product.get_absolute_url }}"
						class="borderLeftRight magnifyText"
						>{{product.title}}</a
					>					
				</div>

				<div class="main__product_description">{{product.description}}</div>
			</div>

			<div class="cart-wishlist__product-second">
				<div class="main__rating margin">
					<i class="far fa-thumbs-up"></i>
					<span>0</span>
					<i class="far fa-thumbs-down"></i>
					<span>0</span>
				</div>
				<div class="cart__product-qty">
					<button class="overlayLeftBtn delete-qty qty-properties-btns">
						<span>-</span>
					</button>
					<span name="product_qty">{{i.qty}}</span>
					<button class="overlayLeftBtn add-qty qty-properties-btns">
						<span>+</span>
					</button>
				</div>
				<div class="main__price margin">
					{% if product.sale_value > 0 %}
					<span class="main__del_price"
						><del>{{product.price|floatformat:2}} ₽</del></span
					>
					<span class="main__sale background"
						>{{product.get_total_sale|floatformat:1}} ₽</span
					>
					{% else %}
					<span class="background">{{product.price|floatformat}} ₽</span>
					{% endif %}
				</div>
			</div>
		</div>
	</article>

	{% endif %} {% endfor %} {% endfor %}
	<div class="cart-wishlist__order">
		<div class="cart-wishlist__checkout">
			<a href="{% url 'checkout' %}"
				><button class="snapLeftBtn margin">
					<span>
						<i class="fas fa-shopping-cart"></i> Оформить
					</span>
				</button></a
			>
		</div>
		<div class="cart-wishlist__form">
			<form action="{% url 'cart:cart-delete-all'%}" method="POST">
				{% csrf_token %}
				<input type="hidden" name="url_from" value="{{request.path}}" />
				<button class="overlayLeftBtn delete wishlist-del">
					<span>
						Удалить все
						<i class="fas fa-trash-alt"></i>
					</span>
				</button>
			</form>
		</div>
    </div>
</div>
{% else %}
<h3 class="main__title">Ваша корзина пуста</h3>
{% endif %} {% endblock content %}
